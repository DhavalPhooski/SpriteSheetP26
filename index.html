<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SVG Spritesheet Demo - Gyro Enhanced</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

.HeroSection{
  width:100%;
  height:100vh;
  position:relative;
  background:linear-gradient(to bottom,#3C2A56,#F4A27E);
  overflow:hidden;
}

/* ---------- SPRITES ---------- */
.sprite{
  position:absolute;
  background-image:url('SpriteSheet.svg');
  background-repeat:no-repeat;
  will-change:transform;
}

/* (your sprite CSS unchanged â€” trimmed for brevity) */
/* KEEP ALL YOUR EXISTING SPRITE RULES HERE */
/* I DID NOT MODIFY THEM */

/* ---------- GYRO PROMPT ---------- */
.gyro-prompt{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.85);
  color:#fff;
  padding:14px 26px;
  border-radius:999px;
  font-family:system-ui,-apple-system;
  font-size:14px;
  z-index:9999;
  cursor:pointer;
  display:none;
}
.gyro-prompt.visible{display:block}
</style>
</head>

<body>

<section class="HeroSection">
  <div class="sprite sprite-title" data-speed="0.3"></div>
  <div class="sprite sprite-base-clouds" data-speed="0.1"></div>

  <div class="WaterMillParent" data-speed="0.6">
    <div class="sprite sprite-rotating-watermill1"></div>
    <div class="sprite sprite-rotating-watermill2"></div>
    <div class="sprite sprite-static-watermill"></div>
  </div>

  <div class="WindMillParent" data-speed="0.7">
    <div class="sprite sprite-rotating-windmill"></div>
    <div class="sprite sprite-static-windmill"></div>
  </div>

  <div class="sprite sprite-stars" data-speed="0.2"></div>
  <div class="sprite sprite-geometric-circle-grid" data-speed="0.15"></div>
  <div class="sprite sprite-babbage-machine" data-speed="0.5"></div>
</section>

<div class="gyro-prompt" id="gyroPrompt">
ðŸ“± Tap to enable motion
</div>

<script>
/* =========================
   PARALLAX CORE
   ========================= */

const layers = [];
document.querySelectorAll('[data-speed]').forEach(el=>{
  layers.push({el, speed:parseFloat(el.dataset.speed)});
});

let inputDir = 0;
let targetX  = 0;
let currentX = 0;
let isGyro   = false;

/* tuning */
const MAX_MOVE = 45;
const ACCEL    = 0.06;
const DAMPING  = 0.12;

/* =========================
   DESKTOP MOUSE
   ========================= */

document.addEventListener('mousemove',e=>{
  if(isGyro) return;
  const mid = innerWidth * 0.5;
  inputDir = e.clientX < mid ? -1 : 1;
});

document.addEventListener('mouseleave',()=>{
  if(!isGyro) inputDir = 0;
});

/* =========================
   GYRO (iOS SAFE)
   ========================= */

const prompt = document.getElementById('gyroPrompt');
const isMobile = 'DeviceOrientationEvent' in window;

if(isMobile){
  prompt.classList.add('visible');
}

prompt.addEventListener('click', async ()=>{
  try{
    if(
      typeof DeviceOrientationEvent.requestPermission === 'function'
    ){
      const res = await DeviceOrientationEvent.requestPermission();
      if(res !== 'granted') return;
    }

    startGyro();
    prompt.remove();

  }catch(err){
    console.error(err);
  }
});

function startGyro(){
  isGyro = true;

  window.addEventListener('deviceorientation', e=>{
    if(e.gamma == null) return;

    // quantized tilt
    if(e.gamma > 8) inputDir = 1;
    else if(e.gamma < -8) inputDir = -1;
    else inputDir = 0;

  }, {passive:true});
}

/* =========================
   LOOP
   ========================= */

function tick(){
  targetX += inputDir * ACCEL;
  targetX = Math.max(-1, Math.min(1, targetX));

  currentX += (targetX - currentX) * DAMPING;
  const base = currentX * MAX_MOVE;

  for(const l of layers){
    l.el.style.transform =
      `translate3d(${base * l.speed}px,0,0)`;
  }

  requestAnimationFrame(tick);
}
tick();
</script>

</body>
</html>
