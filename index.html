<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Spritesheet Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .HeroSection {
            width: 100%;
            height: 100vh;
            position: relative;
            background: linear-gradient(to bottom, #3C2A56, #F4A27E);
            overflow: hidden;
        }

        /* Base sprite class with performance optimizations */
        .sprite {
            display: block;
            position: absolute;
            background-image: url('SpriteSheet.svg');
            background-repeat: no-repeat;
            will-change: transform;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* Individual sprite positions */
        .sprite-title {
            left: 50%;
            width: 2100px;
            height: 425px;
            background-position: 0 0;
            transform: translateX(-50%) scale(0.5);
            z-index: 50;
        }

        .sprite-base-clouds {
            bottom: 0;
            left: 0;
            width: 1525px;
            height: 425px;
            background-position: -2100px 0;
            transform: scale(1.7);
            z-index: 200;
        }

        .WaterMillParent {
            right: 0;
            bottom: 0;
            position: absolute;
            width: 600px;
            height: 600px;
            transform: scale(0.8);
            z-index: 100;
        }

        .sprite-rotating-watermill1 {
            position: absolute;
            left: -16%;
            bottom: 0;
            width: 699px;
            height: 450px;
            background-position: -831px -425px;
            z-index: 80;
            transform-origin: 46.5% 52%;
            animation: rotate 10s linear infinite;
        }

        .sprite-rotating-watermill2 {
            position: absolute;
            left: -3%;
            bottom: -1%;
            width: 570px;
            height: 450px;
            background-position: -1530px -425px;
            z-index: 90;
            animation: rotate2 11s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotateZ(0deg) scale(0.9); }
            to { transform: rotateZ(-360deg) scale(0.9); }
        }

        @keyframes rotate2 {
            from { transform: rotateZ(0deg) scale(0.7); }
            to { transform: rotateZ(-360deg) scale(0.7); }
        }

        .sprite-static-watermill {
            position: absolute;
            right: -30%;
            bottom: -30%;
            width: 831px;
            height: 949px;
            background-position: 0 -875px;
            transform: scale(0.7);
            z-index: 100;
        }

        .WindMillParent {
            left: 0;
            top: 15%;
            position: absolute;
            width: 600px;
            height: 600px;
            z-index: 100;
            transform: scale(1.2);
        }

        .sprite-rotating-windmill {
            position: absolute;
            left: 10%;
            top: -8%;
            width: 470px;
            height: 450px;
            transform-origin: 52% 50%;
            background-position: 0 -425px;
            animation: rotate2 11s linear infinite;
        }

        .sprite-static-windmill {
            position: absolute;
            transform: scale(0.5);
            bottom: -40%;
            left: -8%;
            width: 699px;
            height: 949px;
            background-position: -831px -875px;
        }

        .sprite-title-cloud1 {
            width: 470px;
            height: 739px;
            background-position: 0 -2050px;
            opacity: 0;
        }

        .sprite-title-cloud2 {
            width: 1269px;
            height: 739px;
            background-position: -831px -2050px;
            opacity: 0;
        }

        .sprite-stars {
            position: absolute;
            top: -20%;
            width: 1952px;
            height: 450px;
            background-position: -2100px -425px;
            z-index: 10;
        }

        .sprite-geometric-circle-grid {
            width: 1952px;
            height: 1394px;
            background-position: -2100px -1395px;
            z-index: 10;
            left: -5%;
        }

        .sprite-babbage-machine {
            position: absolute;
            left: 50%;
            bottom: -15%;
            width: 1269px;
            height: 739px;
            background-position: -831px -2050px;
            transform: translateX(-50%) scale(0.5);
            z-index: 100;
        }

        /* Preload hint */
        body::before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            background-image: url('SpriteSheet.svg');
        }
    </style>
</head>

<body>
    <section class="HeroSection" id="heroSection">
        <div class="sprite sprite-title" data-speed="0.3"></div>
        <div class="sprite sprite-base-clouds" data-speed="0.1"></div>

        <div class="WaterMillParent" data-speed="0.6">
            <div class="sprite sprite-rotating-watermill1"></div>
            <div class="sprite sprite-rotating-watermill2"></div>
            <div class="sprite sprite-static-watermill"></div>
        </div>

        <div class="WindMillParent" data-speed="0.7">
            <div class="sprite sprite-rotating-windmill"></div>
            <div class="sprite sprite-static-windmill"></div>
        </div>

        <div class="sprite sprite-stars" data-speed="0.2"></div>
        <div class="sprite sprite-geometric-circle-grid" data-speed="0.15"></div>
        <div class="sprite sprite-babbage-machine" data-speed="0.5"></div>
    </section>

    <script>
        // Optimized parallax effect
        const heroSection = document.getElementById('heroSection');
        const parallaxElements = document.querySelectorAll('[data-speed]');
        
        let mouseX = 0;
        let currentX = 0;
        let rafId = null;

        // Throttled mouse move handler
        heroSection.addEventListener('mousemove', (e) => {
            const rect = heroSection.getBoundingClientRect();
            // Normalize to -1 to 1 range
            mouseX = ((e.clientX - rect.left) / rect.width - 0.5) * 2;
        });

        // Reset on mouse leave
        heroSection.addEventListener('mouseleave', () => {
            mouseX = 0;
        });

        // Smooth animation loop
        function animate() {
            // Smooth interpolation
            currentX += (mouseX - currentX) * 0.05;

            parallaxElements.forEach(el => {
                const speed = parseFloat(el.dataset.speed);
                const movement = currentX * 50 * speed; // Max 50px movement
                
                // Get existing transform
                const currentTransform = el.style.transform || getComputedStyle(el).transform;
                
                // Apply parallax while preserving other transforms
                if (currentTransform && currentTransform !== 'none') {
                    el.style.transform = `translateX(${movement}px) ${currentTransform.replace(/translateX\([^)]+\)\s*/, '')}`;
                } else {
                    el.style.transform = `translateX(${movement}px)`;
                }
            });

            rafId = requestAnimationFrame(animate);
        }

        // Start animation
        animate();

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (rafId) cancelAnimationFrame(rafId);
        });
    </script>
</body>
</html>