<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SVG Spritesheet Demo - Gyro Enhanced</title>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.HeroSection {
  width: 100%;
  height: 100vh;
  position: relative;
  background: linear-gradient(to bottom, #3C2A56, #F4A27E);
  overflow: hidden;
}

/* =====================
   SPRITE BASE (CRITICAL)
   ===================== */
.sprite {
  position: absolute;
  background-image: url("SpriteSheet.svg");
  background-repeat: no-repeat;
  will-change: transform;

  /* ðŸ”¥ base transform + dynamic offset */
  transform: var(--base-transform, none)
             translate3d(var(--px, 0px), 0, 0);
}

/* =====================
   SPRITES
   ===================== */

.sprite-title {
  left: 50%;
  width: 2100px;
  height: 425px;
  background-position: 0 0;
  z-index: 50;
  --base-transform: translateX(-50%) scale(0.5);
}

.sprite-base-clouds {
  bottom: 0;
  left: 0;
  width: 1525px;
  height: 425px;
  background-position: -2100px 0;
  z-index: 200;
  --base-transform: scale(1.7);
}

.WaterMillParent {
  right: 0;
  bottom: 0;
  position: absolute;
  width: 600px;
  height: 600px;
  z-index: 100;
  --base-transform: scale(0.8);
}

.WaterMillParent {
  transform: var(--base-transform)
             translate3d(var(--px, 0px), 0, 0);
}

.sprite-rotating-watermill1 {
  position: absolute;
  left: -16%;
  bottom: 0;
  width: 699px;
  height: 450px;
  background-position: -831px -425px;
  transform-origin: 46.5% 52%;
  animation: rotate 10s linear infinite;
}

.sprite-rotating-watermill2 {
  position: absolute;
  left: -3%;
  bottom: -1%;
  width: 570px;
  height: 450px;
  background-position: -1530px -425px;
  animation: rotate2 11s linear infinite;
}

@keyframes rotate {
  from { transform: rotate(0deg) scale(0.9); }
  to   { transform: rotate(-360deg) scale(0.9); }
}

@keyframes rotate2 {
  from { transform: rotate(0deg) scale(0.7); }
  to   { transform: rotate(-360deg) scale(0.7); }
}

.sprite-static-watermill {
  position: absolute;
  right: -30%;
  bottom: -30%;
  width: 831px;
  height: 949px;
  background-position: 0 -875px;
  transform: scale(0.7);
}

.WindMillParent {
  left: 0;
  top: 15%;
  position: absolute;
  width: 600px;
  height: 600px;
  z-index: 100;
  --base-transform: scale(1.2);
}

.WindMillParent {
  transform: var(--base-transform)
             translate3d(var(--px, 0px), 0, 0);
}

.sprite-rotating-windmill {
  position: absolute;
  left: 10%;
  top: -8%;
  width: 470px;
  height: 450px;
  background-position: 0 -425px;
  transform-origin: 52% 50%;
  animation: rotate2 11s linear infinite;
}

.sprite-static-windmill {
  position: absolute;
  bottom: -40%;
  left: -8%;
  width: 699px;
  height: 949px;
  background-position: -831px -875px;
  transform: scale(0.5);
}

.sprite-stars {
  top: -20%;
  width: 1952px;
  height: 450px;
  background-position: -2100px -425px;
  z-index: 10;
}

.sprite-geometric-circle-grid {
  left: -5%;
  width: 1952px;
  height: 1394px;
  background-position: -2100px -1395px;
  z-index: 10;
}

.sprite-babbage-machine {
  left: 50%;
  bottom: -15%;
  width: 1269px;
  height: 739px;
  background-position: -831px -2050px;
  z-index: 100;
  --base-transform: translateX(-50%) scale(0.5);
}

/* =====================
   GYRO PROMPT
   ===================== */
.gyro-prompt {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.85);
  color: white;
  padding: 14px 26px;
  border-radius: 999px;
  font-family: system-ui, -apple-system;
  font-size: 14px;
  z-index: 9999;
  cursor: pointer;
  display: none;
}

.gyro-prompt.visible {
  display: block;
}
</style>
</head>

<body>

<section class="HeroSection">
  <div class="sprite sprite-title" data-speed="0.3"></div>
  <div class="sprite sprite-base-clouds" data-speed="0.1"></div>

  <div class="WaterMillParent" data-speed="0.6">
    <div class="sprite sprite-rotating-watermill1"></div>
    <div class="sprite sprite-rotating-watermill2"></div>
    <div class="sprite sprite-static-watermill"></div>
  </div>

  <div class="WindMillParent" data-speed="0.7">
    <div class="sprite sprite-rotating-windmill"></div>
    <div class="sprite sprite-static-windmill"></div>
  </div>

  <div class="sprite sprite-stars" data-speed="0.2"></div>
  <div class="sprite sprite-geometric-circle-grid" data-speed="0.15"></div>
  <div class="sprite sprite-babbage-machine" data-speed="0.5"></div>
</section>

<div class="gyro-prompt" id="gyroPrompt">
ðŸ“± Tap to enable motion
</div>

<script>
/* =====================
   PARALLAX CORE
   ===================== */

const layers = [];
document.querySelectorAll('[data-speed]').forEach(el => {
  layers.push({
    el,
    speed: parseFloat(el.dataset.speed)
  });
});

let inputDir = 0;
let targetX = 0;
let currentX = 0;
let isGyro = false;

const MAX_MOVE = 45;
const ACCEL = 0.06;
const DAMPING = 0.12;

/* =====================
   DESKTOP
   ===================== */
document.addEventListener('mousemove', e => {
  if (isGyro) return;
  inputDir = e.clientX < innerWidth * 0.5 ? -1 : 1;
});

document.addEventListener('mouseleave', () => {
  if (!isGyro) inputDir = 0;
});

/* =====================
   GYRO (iOS + ANDROID)
   ===================== */
const prompt = document.getElementById('gyroPrompt');

if ('DeviceOrientationEvent' in window) {
  prompt.classList.add('visible');
}

prompt.addEventListener('click', async () => {
  if (typeof DeviceOrientationEvent.requestPermission === 'function') {
    const res = await DeviceOrientationEvent.requestPermission();
    if (res !== 'granted') return;
  }

  isGyro = true;
  prompt.remove();

  window.addEventListener('deviceorientation', e => {
    if (e.gamma == null) return;

    if (e.gamma > 8) inputDir = 1;
    else if (e.gamma < -8) inputDir = -1;
    else inputDir = 0;
  }, { passive: true });
});

/* =====================
   LOOP
   ===================== */
function tick() {
  targetX += inputDir * ACCEL;
  targetX = Math.max(-1, Math.min(1, targetX));

  currentX += (targetX - currentX) * DAMPING;
  const base = currentX * MAX_MOVE;

  for (const l of layers) {
    l.el.style.setProperty('--px', `${base * l.speed}px`);
  }

  requestAnimationFrame(tick);
}

tick();
</script>

</body>
</html>
